import json

from mopilot import StatTensor

import torch

data = torch.randn(1,5,5,5)

stat = StatTensor(data)
print(f"{json.dumps(stat.to_json(), indent=4)}")

"""
output:
{
    "count": 125,
    "min": -2.9305858612060547,
    "max": 2.4062154293060303,
    "std": 0.9648866057395935,
    "mean": -0.036630500108003616,
    "histogram": {
        "hist": [
            1.0,
            1.0,
            13.0,
            12.0,
            22.0,
            32.0,
            18.0,
            17.0,
            6.0,
            3.0
        ],
        "bin_edges": [
            -2.9305858612060547,
            -2.3969056606292725,
            -1.8632255792617798,
            -1.329545497894287,
            -0.7958652973175049,
            -0.26218533515930176,
            0.27149486541748047,
            0.8051750659942627,
            1.3388551473617554,
            1.872535228729248,
            2.4062154293060303
        ]
    },
    "quantile": [
        -0.6715495586395264,
        -0.04066978767514229,
        0.6862677931785583
    ]
}
"""